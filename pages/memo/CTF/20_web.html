<!DOCTYPE html>
<html lang="jp">

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>web | 逝く道</title>
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="web" />
<meta property="og:locale" content="jp" />
<meta name="description" content="どこまでも逝こう。" />
<meta property="og:description" content="どこまでも逝こう。" />
<link rel="canonical" href="/pages/memo/CTF/20_web.html" />
<meta property="og:url" content="/pages/memo/CTF/20_web.html" />
<meta property="og:site_name" content="逝く道" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="web" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"どこまでも逝こう。","headline":"web","url":"/pages/memo/CTF/20_web.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="逝く道" /><!-- Global site tag (gtag.js) - Google Analytics -->
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-Y8XBTJHM0K"></script>
      <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-Y8XBTJHM0K');
      </script></head> 

  

  <body><header class="site-header" role="banner">

  <div class="wrapper">
    <a class="site-title" rel="author" href="/">逝く道</a>
    
    <nav class="site-nav">
      <input type="checkbox" id="nav-trigger" class="nav-trigger" />
      <label for="nav-trigger">
        <span class="menu-icon">
          <svg viewBox="0 0 18 15" width="18px" height="15px">
            <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
          </svg>
        </span>
      </label>

      <div class="trigger"><a class="page-link" href="/diary/">Diary</a><a class="page-link" href="/tech/">Tech</a><a class="page-link" href="/novel/">Novel</a><a class="page-link" href="/memo/">Memo</a><a class="page-link" href="/junk/">Junk</a><a class="page-link" href="/about/">About</a></div>

    </nav>
  </div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title">web</h1>
  </header>

  <div class="post-content"><details>
        <summary>目次</summary><ul><li><a href="#web">web</a><ul><li><a href="#sqlインジェクション">SQLインジェクション</a></li><li><a href="#クロスサイトスクリプティング">クロスサイトスクリプティング</a></li><li><a href="#クロスサイトリクエストフォージェリ">クロスサイトリクエストフォージェリ</a></li></ul></li><li><a href="#認可-authorization-">認可( Authorization )</a><ul><li><a href="#oauth">OAuth</a></li></ul></li><li><a href="#認証-authentication-">認証( Authentication )</a><ul><li><a href="#html-form認証">HTML Form認証</a></li><li><a href="#basic認証">Basic認証</a></li><li><a href="#digest認証">Digest認証</a></li><li><a href="#bearer認証">Bearer認証</a></li></ul></li><li><a href="#http">HTTP</a></li><li><a href="#curl">curl</a></li><li><a href="#php">PHP</a></li></ul></details><h2 id="web">web</h2>

<ul>
  <li>SQLインジェクション</li>
  <li>クロスサイトスクリプティング</li>
  <li>クロスサイトリクエストフォージェリ</li>
</ul>

<h3 id="sqlインジェクション">SQLインジェクション</h3>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">users</span> <span class="k">WHERE</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">'t'</span> <span class="k">OR</span> <span class="s1">'t'</span> <span class="o">=</span> <span class="s1">'t'</span><span class="p">;</span>
</code></pre></div></div>

<p>OR以降が必ず true になる。入力を直接SQLに利用している場合、このように意図しないSQLをユーザーが指定出来てしまう。</p>

<h3 id="クロスサイトスクリプティング">クロスサイトスクリプティング</h3>
<p>不適切な入力確認 (CWE-20) によるインジェクション (CWE-74)</p>

<h3 id="クロスサイトリクエストフォージェリ">クロスサイトリクエストフォージェリ</h3>
<p>データ認証の不十分な検証 (CWE-345) による脆弱性</p>

<h2 id="認可-authorization-">認可( Authorization )</h2>
<ul>
  <li>OAuth</li>
</ul>

<h3 id="oauth">OAuth</h3>
<p>認証用のトークンを発行する。クライアントからの要求が正当であれば。</p>

<p>現行は OAuth2.0 であり、 OAuth1.0 との後方互換性なし。</p>

<p>アクセストークンは Bearer認証・Form認証・OpenID Connect などで利用できる。</p>

<h2 id="認証-authentication-">認証( Authentication )</h2>
<ul>
  <li>HTML Form認証</li>
  <li>Basic認証</li>
  <li>Digest認証</li>
  <li>Bearer認証</li>
</ul>

<h3 id="html-form認証">HTML Form認証</h3>
<p>ユーザー名とパスワードをフォームに入力し送信、サーバー側で一致を確認し、認証する方式。</p>

<p>クロスサイトリクエストフォージェリ (cross-site request forgeries) (CSRF, XSRF) 対策が必要。</p>

<h3 id="basic認証">Basic認証</h3>
<p>ユーザー名とパスワードを Base64 で変換する方式</p>

<p>ユーザ名とパスワードを「:」でつなげて Base64</p>

<p>SSL(HTTPS)を利用すれば平文でパスワード送信するという欠点を補える。</p>

<h3 id="digest認証">Digest認証</h3>
<p>ユーザー名とパスワードとランダムな文字列を MD5(暗号学的ハッシュ関数) で変換する方式</p>

<p>パスワードと nouce（サーバーから送られてきたランダムな文字列） と cnouce（クライアントが生成したランダムな文字列）を組み合わせて MD5 でハッシュ( response ) を生成する。</p>

<p>Basic認証よりはセキュアだが未だ脆弱。SSL(HTTPS)との併用は欠かせない。</p>

<ul>
  <li>認証領域 (realm)</li>
  <li>サーバーがサポートしている qop (quality of protection)</li>
</ul>

<h3 id="bearer認証">Bearer認証</h3>
<p>事前に入手したアクセストークンをtoken68形式を送り、サーバー側はそれが有効化を確認する方式</p>

<p>アクセストークンは OAuth で取得した者を使う。トークンはブラウザ( localStorage or session)に保存している。</p>

<p>Bearer認証は OAuth の仕様の一部として定義されているが、HTTPでも利用可能になっている。</p>

<ol>
  <li>OAuth(認可): ある個人を特定すること</li>
  <li>Bearer(認証): 行動やリソースの許可をすること</li>
</ol>

<p>の順番で利用する。</p>

<p>token68は <code class="language-plaintext highlighter-rouge">a-zA-z0-9</code> の62文字と <code class="language-plaintext highlighter-rouge">-._~+/</code> の6文字の計68文字で構成され、末尾には <code class="language-plaintext highlighter-rouge">=</code> が挿入されることも（パディングかな）</p>

<p>Googleサインインはこれ。</p>

<p>Bearer認証は OpenID Connect に含まれる…と思うのだが、良く分からない。保留。でも、多分、含まれる。含まれるというか等価だと思う。不明。</p>

<h2 id="http">HTTP</h2>

<h2 id="curl">curl</h2>

<h2 id="php">PHP</h2>
<ul>
  <li>Apache Magica (CVE-2012-1823) 攻撃</li>
</ul>

  </div>

</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-text">逝く道 | subscribe <a href="/feed.xml">via RSS</a> |どこまでも逝こう。</div></div>

  </div>

</footer>
<!-- [CDN] mermaid.js -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({startOnLoad:true});</script></body>

</html>
